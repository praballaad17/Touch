{"version":3,"sources":["../node_modules/uuid/dist/esm-browser/rng.js","../node_modules/uuid/dist/esm-browser/regex.js","../node_modules/uuid/dist/esm-browser/stringify.js","../node_modules/uuid/dist/esm-browser/validate.js","../node_modules/uuid/dist/esm-browser/v4.js","components/newpost/uploadPreview.js","components/newpost/progressModal.js","components/newpost/newpost.js"],"names":["getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","validate","uuid","REGEX","test","byteToHex","i","push","toString","substr","stringify","arr","offset","arguments","length","undefined","toLowerCase","TypeError","v4","options","buf","rnds","random","UploadPreview","files","onChange","className","map","file","index","icon","faWindowClose","onClick","handleClose","src","alt","ProgressModal","open","progress","onClose","useEffect","document","querySelector","style","width","ReactDom","createPortal","getElementById","Newpost","title","setPostId","uuidV4","loggedInUser","useUser","user","usePost","postFeed","setTimeline","useUserPost","addToAllProfilePost","useState","filePreviw","setFilePreviw","setUploading","subfiles","setSubfiles","subfilesName","setSubfilesName","caption","setCaption","pgModal","setpgModal","postId","resizeFile","useHistory","Promise","resolve","Resizer","imageFileResizer","uri","handleFileUpload","e","a","target","resizeImage","prevFile","URL","createObjectURL","filename","prevFiles","prevFilename","handleSubmit","console","log","uploadFileToStorage","username","fileurl","error","response","classList","remove","add","disabled","id","name","indexOf","filter","item","splice","placeholder","onInput","value","faImage","type","opacity","position","left"],"mappings":"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","file":"static/js/12.95eb4248.chunk.js","sourcesContent":["// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","import React from 'react'\r\nimport { faWindowClose } from '@fortawesome/free-solid-svg-icons'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\n\r\nexport default function UploadPreview({ files, onChange }) {\r\n\r\n    const handleClose = (file) => {\r\n        onChange(file)\r\n    }\r\n\r\n    if (!files.length) return null;\r\n\r\n    return (\r\n        <div className=\"file-privew\">\r\n            {files.map((file, index) => (\r\n                <div key={index} className=\"file-privew__item\">\r\n                    <FontAwesomeIcon icon={faWindowClose} className=\"file-privew__close\" onClick={() => handleClose(file)} />\r\n                    <img src={file} alt=\"upload-img\" />\r\n\r\n                </div>\r\n            ))}\r\n        </div>\r\n    )\r\n}\r\n","import React, { useEffect } from 'react'\r\nimport ReactDom from 'react-dom'\r\n\r\nexport default function ProgressModal({ open, onClose, progress }) {\r\n    useEffect(() => {\r\n        document.querySelector(\".progress__bar\").style.width = progress\r\n    }, [progress])\r\n\r\n    if (!open) return null\r\n    \r\n    return ReactDom.createPortal(\r\n        <>\r\n            <div className=\"modal-layout\"></div>\r\n            <div className=\"modal-box\">\r\n                <div className=\"modal-box__heading heading-black u-center-text\">Progress</div>\r\n                <ul className=\"modal-box__list\">\r\n                    <li className=\"modal-box__item\" >{progress}</li>\r\n                    <li><div className=\"progress\">\r\n                        <div className=\"progress__bar\"></div>\r\n                        <div className=\"progress__base\"></div>\r\n                    </div></li>\r\n                </ul>\r\n            </div>\r\n        </>,\r\n        document.getElementById(\"modal\")\r\n    )\r\n}\r\n","import React, { useState, useEffect } from 'react'\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { faImage } from '@fortawesome/free-solid-svg-icons'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport Resizer from \"react-image-file-resizer\";\r\nimport { v4 as uuidV4 } from \"uuid\"\r\nimport UploadPreview from './uploadPreview'\r\nimport { TIMELINE } from '../../constants/routes'\r\nimport { postByUsername } from '../../services/postServices';\r\nimport ProgressModal from './progressModal';\r\nimport { uploadFileToStorage } from '../../services/resizeService';\r\nimport { useUser } from '../../context/userProvider';\r\nimport { usePost } from '../../context/postProvider';\r\nimport { useUserPost } from '../../context/userPostProvider';\r\n\r\nexport default function Newpost() {\r\n    useEffect(() => {\r\n        document.title = 'New Post | Touch';\r\n        setPostId(uuidV4())\r\n    }, []);\r\n\r\n    const { user: loggedInUser } = useUser()\r\n    const { setTimeline, postFeed } = usePost()\r\n    const { addToAllProfilePost } = useUserPost()\r\n    const [filePreviw, setFilePreviw] = useState([])\r\n    const [uploading, setUploading] = useState(false)\r\n    const [subfiles, setSubfiles] = useState([])\r\n    const [subfilesName, setSubfilesName] = useState([])\r\n    const [caption, setCaption] = useState(\"\")\r\n    const [progress, setProgress] = useState(\"\")\r\n    const [pgModal, setpgModal] = useState(false)\r\n    const [postId, setPostId] = useState()\r\n    let history = useHistory()\r\n\r\n\r\n    const resizeFile = (file) =>\r\n        new Promise((resolve) => {\r\n            Resizer.imageFileResizer(file, 640, 480, \"JPEG\", 100, 0, (uri) => resolve(uri), \"file\");\r\n        });\r\n\r\n    const handleFileUpload = async (e) => {\r\n        if (!e.target.files.length) return;\r\n        if (subfiles.length === 4) return;\r\n        const file = e.target.files[0]\r\n        const resizeImage = await resizeFile(file);\r\n        setFilePreviw(prevFile => [...prevFile, URL.createObjectURL(resizeImage)])\r\n        const filename = uuidV4()\r\n        setSubfiles(prevFiles => [...prevFiles, resizeImage])\r\n        setSubfilesName(prevFilename => [...prevFilename, filename])\r\n    }\r\n\r\n    const handleCaption = (e) => {\r\n        setCaption(e.target.value)\r\n    }\r\n\r\n    const handleFileCross = (name) => {\r\n        const index = filePreviw.indexOf(name)\r\n        setFilePreviw(filePreviw.filter(item => item !== name))\r\n        subfiles.splice(index, 1)\r\n        subfilesName.splice(index, 1)\r\n    }\r\n\r\n    const progressFn = {\r\n        onUploadProgress: (progressEvent) => {\r\n            let progressper = Math.round(progressEvent.loaded / progressEvent.total * 100) + \"%\";\r\n            console.log(progressper);\r\n            setProgress(progressper)\r\n        }\r\n    }\r\n\r\n\r\n    const handleSubmit = async () => {\r\n        let files = [];\r\n        setUploading(true)\r\n        setpgModal(true)\r\n        for (let i = 0; i < subfiles.length; i++) {\r\n            console.log(\"in loop\");\r\n            const fileurl = await uploadFileToStorage(subfiles[i], `/file/${loggedInUser?.username}/${postId}/${subfilesName[i]}`)\r\n            files.push(fileurl)\r\n        }\r\n\r\n        try {\r\n            postFeed(files, subfilesName, postId, caption)\r\n            // const res = await postByUsername(formData, loggedInUser.username)\r\n            // console.log(data);\r\n            // setTimeline(prevPost => [data, ...prevPost])\r\n            // addToAllProfilePost(loggedInUser?.username, data)\r\n            setUploading(false)\r\n            setpgModal(false)\r\n            // history.push({\r\n            //     pathname: TIMELINE,\r\n            //     data\r\n            // })\r\n        } catch (error) {\r\n            console.log(error.response);\r\n        }\r\n    }\r\n    console.log(filePreviw);\r\n    useEffect(() => {\r\n        if (filePreviw.length > 0) {\r\n            document.getElementById('post_submit').classList.remove(\"btn--grey\")\r\n            document.getElementById('post_submit').classList.add(\"btn--tertiary\")\r\n\r\n        }\r\n        else if (filePreviw.length === 0) {\r\n            console.log(\"zero\");\r\n            document.getElementById('post_submit').classList.remove(\"btn--tertiary\")\r\n            document.getElementById('post_submit').classList.add(\"btn--grey\")\r\n        }\r\n\r\n\r\n    }, [filePreviw])\r\n\r\n    useEffect(() => {\r\n        if (filePreviw.length === 4) {\r\n            console.log(\"diabled\");\r\n            document.getElementById('addpost').classList.add('newpost__media-disabled');\r\n            document.getElementById('addpost-input').disabled = true;\r\n        }\r\n        if (filePreviw.length !== 4) {\r\n            document.getElementById('addpost').classList.remove('newpost__media-disabled');\r\n            document.getElementById('addpost-input').disabled = false;\r\n        }\r\n    }, [filePreviw])\r\n\r\n    return (\r\n        <>\r\n\r\n            <div className=\"newpost__head\">\r\n                <h3 className=\"heading-tertiary\">New Post</h3>\r\n                <div>\r\n                    <button id=\"post_submit\" className=\"btn btn--grey\" onClick={handleSubmit}>Post</button>\r\n                </div>\r\n            </div>\r\n            <div className=\"newpost__main\">\r\n                <div>\r\n                    <UploadPreview files={filePreviw} onChange={handleFileCross} />\r\n                </div>\r\n                <textarea className=\"newpost__input-text\" placeholder=\"compose new post...\" onInput={handleCaption} />\r\n                <label id=\"addpost\" className=\"newpost__media\">\r\n                    <FontAwesomeIcon icon={faImage} />\r\n                    <input id=\"addpost-input\" type=\"file\" style={{ opacity: 0, position: \"absolute\", left: \"-99999px\" }} onChange={handleFileUpload} />\r\n                </label>\r\n            </div>\r\n\r\n            {pgModal && <ProgressModal open={pgModal} progress={progress} onClose={() => setpgModal(false)} />}\r\n        </>\r\n    )\r\n}\r\n"],"sourceRoot":""}